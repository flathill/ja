<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="AsciiDoc 10.2.0">
<title>pve-firewall(8)</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overridden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>


<style type="text/css">
:root {
    /* pre-defined colors */
    --pdt-grey-950: hsl(0deg, 0%, 95%);
    --pdt-grey-750: hsl(0deg, 0%, 75%);
    --pdt-grey-400: hsl(0deg, 0%, 40%);
    --pdt-grey-250: hsl(0deg, 0%, 25%);
    --pdt-grey-150: hsl(0deg, 0%, 15%);
    --pdt-grey-100: hsl(0deg, 0%, 10%);
    --pdt-primary-850: hsl(205deg, 100%, 85%);
    --pdt-primary-800: hsl(205deg, 100%, 80%);
    --pdt-primary-700: hsl(205deg, 100%, 70%);
    --pdt-secondary-850: hsl(250deg, 100%, 85%);
}

/* adjust admonition block spacing. this allows for a background on
 * admonition blocks that doesn't make the elements look to tightly
 * spaced.
 */
div.admonitionblock {
    border-radius: 3px;
    margin: 1.5em 0;
    padding: 0.5em 10% 0.5em 0.5em;
}

div.admonitionblock td.icon {
    padding-right: 0.5em;
}

div.admonitionblock td.icon > img {
    box-sizing: border-box;
    padding: 0.15em;
}

/* Fine-tune headings a bit */
h4 {
  font-size: 1.1em;
}
h5 {
  font-size: 1.05em;
}
h6 {
  font-size: 1.0em;
}

/* Support for heading anchor links */
h3 {
    border-bottom: unset;
}

h3 > span {
    display: inline-block;
    border-bottom: 2px solid silver;
}

a.headerlink {
    color: var(--pdt-grey-750);
    padding: 0 4px;
    text-decoration: none;
    visibility: hidden;
}

/* add it as an pseudo-element, so that it does not show up in the ToC */
a.headerlink::after {
    content: '\00b6';
    text-decoration: none;
}

h1:hover > a.headerlink,
h2:hover > a.headerlink,
h3:hover > a.headerlink,
h4:hover > a.headerlink,
h5:hover > a.headerlink,
h6:hover > a.headerlink {
  visibility: visible;
}

/* Dark mode theme */
@media screen and (prefers-color-scheme: dark) {
    :root {
        color-scheme: dark;
        --pdt-body-background: var(--pdt-grey-150);
        --pdt-text: var(--pdt-grey-950);
        --pdt-headline: var(--pdt-primary-800);
        --pdt-link: var(--pdt-primary-700);
        --pdt-link-visited: var(--pdt-secondary-850);
        --pdt-highlighted-text: var(--pdt-primary-850);
        --pdt-background-sidebar: var(--pdt-grey-100);
        --pdt-background-listings: var(--pdt-grey-100);
        --pdt-border: var(--pdt-grey-400);
        --pdt-border-alt: var(--pdt-grey-250);
        --pdt-table-border: var(--pdt-grey-400);
        --pdt-background-admonition: var(--pdt-grey-250);
    }

    body {
        color: var(--pdt-text);
        background-color: var(--pdt-body-background);
    }

    a {
        color: var(--pdt-link);
    }

    a:visited {
        color: var(--pdt-link-visited);
    }

    /* style headlines, titles etc. */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6,
    thead,
    #author,
    #toctitle,
    div.title,
    td.hdlist1,
    caption.title,
    p.tableblock.header {
        color: var(--pdt-headline);
    }

    h1,
    h2,
    h3,
    #footer {
        border-color: var(--pdt-border);
    }

    /* formatted colored text */
    dt,
    em,
    pre,
    code,
    strong,
    .monospaced {
        color: var(--pdt-highlighted-text);
    }

    /* style the table of contents sidebar */
    div #toc {
        color: var(--pdt-text);
        background-color: var(--pdt-background-sidebar);
        border-color: var(--pdt-border-alt);
    }

    div #toc a:link,
    div #toc a:visited {
        color: var(--pdt-text);
    }

    /* reduce the brigthness of images a bit and make it reversable
     * through hovering over them.
     */
    .image > img {
        filter: brightness(90%);
    }

    .image > img:hover {
        filter: none;
    }

    /* tables */
    th.tableblock,
    td.tableblock,
    table.tableblock {
        border-color: var(--pdt-table-border);
    }

    div.quoteblock,
    div.verseblock {
        color: var(--pdt-text);
        border-color: var(--pdt-border);
    }

    /* listings (e.g. code snippet blocks) */
    div.listingblock > div.content {
        background-color: var(--pdt-background-listings);
        border-color: var(--pdt-border-alt);
    }

    /* admonition blocks (e.g. notes, warnings etc.) */
    div.admonitionblock {
        color: var(--pdt-text);
        background-color: var(--pdt-background-admonition);
    }

    div.admonitionblock td.content {
        border-color: var(--pdt-border);
    }

    /* makes the admonition icons appear a bit more consistent, by
     * adding a white background the shadows in the icons look
     * "correct"
     */
    div.admonitionblock td.icon > img {
        background-color: white;
        border-radius: 100%;
        filter: brightness(95%);
    }

    /* invert the logo */
    #header > h1 > .image > img {
        filter: invert(100%) hue-rotate(180deg) brightness(90%);
    }

    /* fixes the black text on unorderd lists */
    ul > li > * {
        color: var(--pdt-text);
    }
}
</style>

<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article" style="max-width:55em">
<div id="header">
<h1>pve-firewall(8)</h1>
<span id="author">Proxmox Server Solutions GmbH</span><br>
<span id="email" class="monospaced">&lt;<a href="mailto:support@proxmox.com">support@proxmox.com</a>&gt;</span><br>
<span id="revnumber">version 8.4.0,</span>
<span id="revdate">Wed Apr  9 08:00:00 CEST 2025</span>
</div>
<div id="content">
<div class="sect1">
<h2 id="chapter_pve_firewall">
NAME
 <a class="headerlink" href="#chapter_pve_firewall" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>pve-firewall - PVE Firewall Daemon</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_synopsis">
SYNOPSIS
 <a class="headerlink" href="#_synopsis" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>pve-firewall</strong> <span class="monospaced">&lt;COMMAND&gt; [ARGS] [OPTIONS]</span></p></div>
<div class="paragraph">
<p><strong>pve-firewall compile</strong></p></div>
<div class="paragraph">
<p>Compile and print firewall rules. This is useful for testing.</p></div>
<div class="paragraph">
<p><strong>pve-firewall help</strong> <span class="monospaced">[OPTIONS]</span></p></div>
<div class="paragraph">
<p>Get help about specified command.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<span class="monospaced">--extra-args</span> <span class="monospaced">&lt;array&gt;</span> 
</dt>
<dd>
<p>
Shows help for a specific command
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--verbose</span> <span class="monospaced">&lt;boolean&gt;</span> 
</dt>
<dd>
<p>
Verbose output format.
</p>
</dd>
</dl></div>
<div class="paragraph">
<p><strong>pve-firewall localnet</strong></p></div>
<div class="paragraph">
<p>Print information about local network.</p></div>
<div class="paragraph">
<p><strong>pve-firewall restart</strong></p></div>
<div class="paragraph">
<p>Restart the Proxmox VE firewall service.</p></div>
<div class="paragraph">
<p><strong>pve-firewall simulate</strong> <span class="monospaced">[OPTIONS]</span></p></div>
<div class="paragraph">
<p>Simulate firewall rules. This does not simulates the kernel <em>routing</em>
table, but simply assumes that routing from source zone to destination zone
is possible.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<span class="monospaced">--dest</span> <span class="monospaced">&lt;string&gt;</span> 
</dt>
<dd>
<p>
Destination IP address.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--dport</span> <span class="monospaced">&lt;integer&gt;</span> 
</dt>
<dd>
<p>
Destination port.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--from</span> <span class="monospaced">(host|outside|vm\d+|ct\d+|([a-zA-Z][a-zA-Z0-9]{0,9})/(\S+))</span> (<em>default =</em> <span class="monospaced">outside</span>)
</dt>
<dd>
<p>
Source zone.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--protocol</span> <span class="monospaced">(tcp|udp)</span> (<em>default =</em> <span class="monospaced">tcp</span>)
</dt>
<dd>
<p>
Protocol.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--source</span> <span class="monospaced">&lt;string&gt;</span> 
</dt>
<dd>
<p>
Source IP address.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--sport</span> <span class="monospaced">&lt;integer&gt;</span> 
</dt>
<dd>
<p>
Source port.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--to</span> <span class="monospaced">(host|outside|vm\d+|ct\d+|([a-zA-Z][a-zA-Z0-9]{0,9})/(\S+))</span> (<em>default =</em> <span class="monospaced">host</span>)
</dt>
<dd>
<p>
Destination zone.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--verbose</span> <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Verbose output.
</p>
</dd>
</dl></div>
<div class="paragraph">
<p><strong>pve-firewall start</strong> <span class="monospaced">[OPTIONS]</span></p></div>
<div class="paragraph">
<p>Start the Proxmox VE firewall service.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<span class="monospaced">--debug</span> <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Debug mode - stay in foreground
</p>
</dd>
</dl></div>
<div class="paragraph">
<p><strong>pve-firewall status</strong></p></div>
<div class="paragraph">
<p>Get firewall status.</p></div>
<div class="paragraph">
<p><strong>pve-firewall stop</strong></p></div>
<div class="paragraph">
<p>Stop the Proxmox VE firewall service. Note, stopping actively removes all
Proxmox VE related iptable rules rendering the host potentially
unprotected.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_description">
DESCRIPTION
 <a class="headerlink" href="#_description" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Proxmox VE Firewall provides an easy way to protect your IT
infrastructure. You can setup firewall rules for all hosts
inside a cluster, or define rules for virtual machines and
containers. Features like firewall macros, security groups, IP sets
and aliases help to make that task easier.</p></div>
<div class="paragraph">
<p>While all configuration is stored on the cluster file system, the
<span class="monospaced">iptables</span>-based firewall service runs on each cluster node, and thus provides
full isolation between virtual machines. The distributed nature of
this system also provides much higher bandwidth than a central
firewall solution.</p></div>
<div class="paragraph">
<p>The firewall has full support for IPv4 and IPv6. IPv6 support is fully
transparent, and we filter traffic for both protocols by default. So
there is no need to maintain a different set of rules for IPv6.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_directions_amp_zones">
Directions &amp; Zones
 <a class="headerlink" href="#_directions_amp_zones" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Proxmox VE firewall groups the network into multiple logical zones. You can
define rules for each zone independently. Depending on the zone, you can define
rules for incoming, outgoing or forwarded traffic.</p></div>
<div class="sect2">
<h3 id="_directions">
<span>Directions</span>
 <a class="headerlink" href="#_directions" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>There are 3 directions that you can choose from when defining rules for a zone:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
In
</dt>
<dd>
<p>
Traffic that is arriving in a zone.
</p>
</dd>
<dt class="hdlist1">
Out
</dt>
<dd>
<p>
Traffic that is leaving a zone.
</p>
</dd>
<dt class="hdlist1">
Forward
</dt>
<dd>
<p>
Traffic that is passing through a zone. In the host zone this can be routed
traffic (when the host is acting as a gateway or performing NAT). At a
VNet-level this affects all traffic that is passing by a VNet, including
traffic from/to bridged network interfaces.
</p>
</dd>
</dl></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Important" src="data:image/png;base64,
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
EQn3XQAAAABJRU5ErkJggg==">
</td>
<td class="content">Creating rules for forwarded traffic is currently only possible when
using the new <a href="pve-firewall.8.html#pve_firewall_nft">nftables-based proxmox-firewall</a>. Any
forward rules will be ignored by the stock <span class="monospaced">pve-firewall</span> and have no effect!</td>
</tr></table>
</div>
</div>
<div class="sect2">
<h3 id="_zones">
<span>Zones</span>
 <a class="headerlink" href="#_zones" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>There are 3 different zones that you can define firewall rules for:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
Host
</dt>
<dd>
<p>
Traffic going from/to a host, or traffic that is forwarded by a host.
You can define rules for this zone either at the datacenter level or at the host
level. Rules at host level take precedence over rules at datacenter level.
</p>
</dd>
<dt class="hdlist1">
VM
</dt>
<dd>
<p>
Traffic going from/to a VM or CT.
You cannot define rules for forwarded traffic, only for incoming / outgoing
traffic.
</p>
</dd>
<dt class="hdlist1">
VNet
</dt>
<dd>
<p>
Traffic passing through a SDN VNet, either from guest to guest or from host to
guest and vice-versa.
Since this traffic is always forwarded traffic, it is only possible to create
rules with direction forward.
</p>
</dd>
</dl></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Important" src="data:image/png;base64,
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
EQn3XQAAAABJRU5ErkJggg==">
</td>
<td class="content">Creating rules on a VNet-level is currently only possible when using
the new <a href="pve-firewall.8.html#pve_firewall_nft">nftables-based proxmox-firewall</a>. Any VNet-level
rules will be ignored by the stock <span class="monospaced">pve-firewall</span> and have no effect!</td>
</tr></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_files">
Configuration Files
 <a class="headerlink" href="#_configuration_files" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All firewall related configuration is stored on the proxmox cluster
file system. So those files are automatically distributed to all
cluster nodes, and the <span class="monospaced">pve-firewall</span> service updates the underlying
<span class="monospaced">iptables</span> rules automatically on changes.</p></div>
<div class="paragraph">
<p>You can configure anything using the GUI (i.e. <strong>Datacenter</strong> &#8594; <strong>Firewall</strong>,
or on a <strong>Node</strong> &#8594; <strong>Firewall</strong>), or you can edit the configuration files
directly using your preferred editor.</p></div>
<div class="paragraph">
<p>Firewall configuration files contain sections of key-value
pairs. Lines beginning with a <span class="monospaced">#</span> and blank lines are considered
comments. Sections start with a header line containing the section
name enclosed in <span class="monospaced">[</span> and <span class="monospaced">]</span>.</p></div>
<div class="sect2">
<h3 id="pve_firewall_cluster_wide_setup">
<span>Cluster Wide Setup</span>
 <a class="headerlink" href="#pve_firewall_cluster_wide_setup" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>The cluster-wide firewall configuration is stored at:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>/etc/pve/firewall/cluster.fw</pre>
</div></div>
<div class="paragraph">
<p>The configuration can contain the following sections:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<span class="monospaced">[OPTIONS]</span>
</dt>
<dd>
<p>
This is used to set cluster-wide firewall options.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">ebtables</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">1</span>)
</dt>
<dd>
<p>
Enable ebtables rules cluster wide.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">enable</span>: <span class="monospaced">&lt;integer&gt; (0 - N)</span> 
</dt>
<dd>
<p>
Enable or disable the firewall cluster wide.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">log_ratelimit</span>: <span class="monospaced">[enable=]&lt;1|0&gt; [,burst=&lt;integer&gt;] [,rate=&lt;rate&gt;]</span> 
</dt>
<dd>
<p>
Log ratelimiting settings
</p>
<div class="dlist"><dl>
<dt class="hdlist1">
<span class="monospaced">burst</span>=<span class="monospaced">&lt;integer&gt; (0 - N)</span> (<em>default =</em> <span class="monospaced">5</span>)
</dt>
<dd>
<p>
Initial burst of packages which will always get logged before the rate is applied
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">enable</span>=<span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">1</span>)
</dt>
<dd>
<p>
Enable or disable log rate limiting
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">rate</span>=<span class="monospaced">&lt;rate&gt;</span> (<em>default =</em> <span class="monospaced">1/second</span>)
</dt>
<dd>
<p>
Frequency with which the burst bucket gets refilled
</p>
</dd>
</dl></div>
</dd>
<dt class="hdlist1">
<span class="monospaced">policy_forward</span>: <span class="monospaced">&lt;ACCEPT | DROP&gt;</span> 
</dt>
<dd>
<p>
Forward policy.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">policy_in</span>: <span class="monospaced">&lt;ACCEPT | DROP | REJECT&gt;</span> 
</dt>
<dd>
<p>
Input policy.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">policy_out</span>: <span class="monospaced">&lt;ACCEPT | DROP | REJECT&gt;</span> 
</dt>
<dd>
<p>
Output policy.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">[RULES]</span>
</dt>
<dd>
<p>
This sections contains cluster-wide firewall rules for all nodes.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">[IPSET &lt;name&gt;]</span>
</dt>
<dd>
<p>
Cluster wide IP set definitions.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">[GROUP &lt;name&gt;]</span>
</dt>
<dd>
<p>
Cluster wide security group definitions.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">[ALIASES]</span>
</dt>
<dd>
<p>
Cluster wide Alias definitions.
</p>
</dd>
</dl></div>
<div class="sect3">
<h4 id="_enabling_the_firewall">Enabling the Firewall
 <a class="headerlink" href="#_enabling_the_firewall" title="Permalink to this heading"></a>
</h4>
<div class="paragraph">
<p>The firewall is completely disabled by default, so you need to
set the enable option here:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>[OPTIONS]
# enable firewall (cluster-wide setting, default is disabled)
enable: 1</pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Important" src="data:image/png;base64,
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
EQn3XQAAAABJRU5ErkJggg==">
</td>
<td class="content">If you enable the firewall, traffic to all hosts is blocked by
default. Only exceptions is WebGUI(8006) and ssh(22) from your local
network.</td>
</tr></table>
</div>
<div class="paragraph">
<p>If you want to administrate your Proxmox VE hosts from remote, you
need to create rules to allow traffic from those remote IPs to the web
GUI (port 8006). You may also want to allow ssh (port 22), and maybe
SPICE (port 3128).</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Tip" src="data:image/png;base64,
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">
</td>
<td class="content">Please open a SSH connection to one of your Proxmox VE hosts before
enabling the firewall. That way you still have access to the host if
something goes wrong .</td>
</tr></table>
</div>
<div class="paragraph">
<p>To simplify that task, you can instead create an IPSet called
&#8220;management&#8221;, and add all remote IPs there. This creates all required
firewall rules to access the GUI from remote.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="pve_firewall_host_specific_configuration">
<span>Host Specific Configuration</span>
 <a class="headerlink" href="#pve_firewall_host_specific_configuration" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>Host related configuration is read from:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>/etc/pve/nodes/&lt;nodename&gt;/host.fw</pre>
</div></div>
<div class="paragraph">
<p>This is useful if you want to overwrite rules from <span class="monospaced">cluster.fw</span>
config. You can also increase log verbosity, and set netfilter related
options. The configuration can contain the following sections:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<span class="monospaced">[OPTIONS]</span>
</dt>
<dd>
<p>
This is used to set host related firewall options.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">enable</span>: <span class="monospaced">&lt;boolean&gt;</span> 
</dt>
<dd>
<p>
Enable host firewall rules.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">log_level_forward</span>: <span class="monospaced">&lt;alert | crit | debug | emerg | err | info | nolog | notice | warning&gt;</span> 
</dt>
<dd>
<p>
Log level for forwarded traffic.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">log_level_in</span>: <span class="monospaced">&lt;alert | crit | debug | emerg | err | info | nolog | notice | warning&gt;</span> 
</dt>
<dd>
<p>
Log level for incoming traffic.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">log_level_out</span>: <span class="monospaced">&lt;alert | crit | debug | emerg | err | info | nolog | notice | warning&gt;</span> 
</dt>
<dd>
<p>
Log level for outgoing traffic.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">log_nf_conntrack</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Enable logging of conntrack information.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">ndp</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Enable NDP (Neighbor Discovery Protocol).
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">nf_conntrack_allow_invalid</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Allow invalid packets on connection tracking.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">nf_conntrack_helpers</span>: <span class="monospaced">&lt;string&gt;</span> (<em>default =</em> ``)
</dt>
<dd>
<p>
Enable conntrack helpers for specific protocols. Supported protocols: amanda, ftp, irc, netbios-ns, pptp, sane, sip, snmp, tftp
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">nf_conntrack_max</span>: <span class="monospaced">&lt;integer&gt; (32768 - N)</span> (<em>default =</em> <span class="monospaced">262144</span>)
</dt>
<dd>
<p>
Maximum number of tracked connections.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">nf_conntrack_tcp_timeout_established</span>: <span class="monospaced">&lt;integer&gt; (7875 - N)</span> (<em>default =</em> <span class="monospaced">432000</span>)
</dt>
<dd>
<p>
Conntrack established timeout.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">nf_conntrack_tcp_timeout_syn_recv</span>: <span class="monospaced">&lt;integer&gt; (30 - 60)</span> (<em>default =</em> <span class="monospaced">60</span>)
</dt>
<dd>
<p>
Conntrack syn recv timeout.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">nftables</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Enable nftables based firewall (tech preview)
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">nosmurfs</span>: <span class="monospaced">&lt;boolean&gt;</span> 
</dt>
<dd>
<p>
Enable SMURFS filter.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">protection_synflood</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Enable synflood protection
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">protection_synflood_burst</span>: <span class="monospaced">&lt;integer&gt;</span> (<em>default =</em> <span class="monospaced">1000</span>)
</dt>
<dd>
<p>
Synflood protection rate burst by ip src.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">protection_synflood_rate</span>: <span class="monospaced">&lt;integer&gt;</span> (<em>default =</em> <span class="monospaced">200</span>)
</dt>
<dd>
<p>
Synflood protection rate syn/sec by ip src.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">smurf_log_level</span>: <span class="monospaced">&lt;alert | crit | debug | emerg | err | info | nolog | notice | warning&gt;</span> 
</dt>
<dd>
<p>
Log level for SMURFS filter.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">tcp_flags_log_level</span>: <span class="monospaced">&lt;alert | crit | debug | emerg | err | info | nolog | notice | warning&gt;</span> 
</dt>
<dd>
<p>
Log level for illegal tcp flags filter.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">tcpflags</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Filter illegal combinations of TCP flags.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">[RULES]</span>
</dt>
<dd>
<p>
This sections contains host specific firewall rules.
</p>
</dd>
</dl></div>
</div>
<div class="sect2">
<h3 id="pve_firewall_vm_container_configuration">
<span>VM/Container Configuration</span>
 <a class="headerlink" href="#pve_firewall_vm_container_configuration" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>VM firewall configuration is read from:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>/etc/pve/firewall/&lt;VMID&gt;.fw</pre>
</div></div>
<div class="paragraph">
<p>and contains the following data:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<span class="monospaced">[OPTIONS]</span>
</dt>
<dd>
<p>
This is used to set VM/Container related firewall options.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">dhcp</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Enable DHCP.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">enable</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Enable/disable firewall rules.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">ipfilter</span>: <span class="monospaced">&lt;boolean&gt;</span> 
</dt>
<dd>
<p>
Enable default IP filters. This is equivalent to adding an empty ipfilter-net&lt;id&gt; ipset for every interface. Such ipsets implicitly contain sane default restrictions such as restricting IPv6 link local addresses to the one derived from the interface&#8217;s MAC address. For containers the configured IP addresses will be implicitly added.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">log_level_in</span>: <span class="monospaced">&lt;alert | crit | debug | emerg | err | info | nolog | notice | warning&gt;</span> 
</dt>
<dd>
<p>
Log level for incoming traffic.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">log_level_out</span>: <span class="monospaced">&lt;alert | crit | debug | emerg | err | info | nolog | notice | warning&gt;</span> 
</dt>
<dd>
<p>
Log level for outgoing traffic.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">macfilter</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">1</span>)
</dt>
<dd>
<p>
Enable/disable MAC address filter.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">ndp</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Enable NDP (Neighbor Discovery Protocol).
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">policy_in</span>: <span class="monospaced">&lt;ACCEPT | DROP | REJECT&gt;</span> 
</dt>
<dd>
<p>
Input policy.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">policy_out</span>: <span class="monospaced">&lt;ACCEPT | DROP | REJECT&gt;</span> 
</dt>
<dd>
<p>
Output policy.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">radv</span>: <span class="monospaced">&lt;boolean&gt;</span> 
</dt>
<dd>
<p>
Allow sending Router Advertisement.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">[RULES]</span>
</dt>
<dd>
<p>
This sections contains VM/Container firewall rules.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">[IPSET &lt;name&gt;]</span>
</dt>
<dd>
<p>
IP set definitions.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">[ALIASES]</span>
</dt>
<dd>
<p>
IP Alias definitions.
</p>
</dd>
</dl></div>
<div class="sect3">
<h4 id="_enabling_the_firewall_for_vms_and_containers">Enabling the Firewall for VMs and Containers
 <a class="headerlink" href="#_enabling_the_firewall_for_vms_and_containers" title="Permalink to this heading"></a>
</h4>
<div class="paragraph">
<p>Each virtual network device has its own firewall enable flag. So you
can selectively enable the firewall for each interface. This is
required in addition to the general firewall <span class="monospaced">enable</span> option.</p></div>
</div>
</div>
<div class="sect2">
<h3 id="pve_firewall_vnet_configuration">
<span>VNet Configuration</span>
 <a class="headerlink" href="#pve_firewall_vnet_configuration" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>VNet related configuration is read from:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>/etc/pve/sdn/firewall/&lt;vnet_name&gt;.fw</pre>
</div></div>
<div class="paragraph">
<p>This can be used for setting firewall configuration globally on a VNet level,
without having to set firewall rules for each VM inside the VNet separately. It
can only contain rules for the <span class="monospaced">FORWARD</span> direction, since there is no notion of
incoming or outgoing traffic. This affects all traffic travelling from one
bridge port to another, including the host interface.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Warning" src="data:image/png;base64,
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
/F/lgJiyQFHragAAAABJRU5ErkJggg==">
</td>
<td class="content">This feature is currently only available for the new
<a href="pve-firewall.8.html#pve_firewall_nft">nftables-based proxmox-firewall</a></td>
</tr></table>
</div>
<div class="paragraph">
<p>Since traffic passing the <span class="monospaced">FORWARD</span> chain is bi-directional, you need to create
rules for both directions if you want traffic to pass both ways. For instance if
HTTP traffic for a specific host should be allowed, you would need to create the
following rules:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>FORWARD ACCEPT -dest 10.0.0.1 -dport 80
FORWARD ACCEPT -source 10.0.0.1 -sport 80</pre>
</div></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<span class="monospaced">[OPTIONS]</span>
</dt>
<dd>
<p>
This is used to set VNet related firewall options.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">enable</span>: <span class="monospaced">&lt;boolean&gt;</span> (<em>default =</em> <span class="monospaced">0</span>)
</dt>
<dd>
<p>
Enable/disable firewall rules.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">log_level_forward</span>: <span class="monospaced">&lt;alert | crit | debug | emerg | err | info | nolog | notice | warning&gt;</span> 
</dt>
<dd>
<p>
Log level for forwarded traffic.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">policy_forward</span>: <span class="monospaced">&lt;ACCEPT | DROP&gt;</span> 
</dt>
<dd>
<p>
Forward policy.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">[RULES]</span>
</dt>
<dd>
<p>
This section contains VNet specific firewall rules.
</p>
</dd>
</dl></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_firewall_rules">
Firewall Rules
 <a class="headerlink" href="#_firewall_rules" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Firewall rules consists of a direction (<span class="monospaced">IN</span>, <span class="monospaced">OUT</span> or <span class="monospaced">FORWARD</span>) and an
action (<span class="monospaced">ACCEPT</span>, <span class="monospaced">DENY</span>, <span class="monospaced">REJECT</span>). You can also specify a macro
name. Macros contain predefined sets of rules and options. Rules can be
disabled by prefixing them with <span class="monospaced">|</span>.</p></div>
<div class="listingblock">
<div class="title">Firewall rules syntax</div>
<div class="content monospaced">
<pre>[RULES]

DIRECTION ACTION [OPTIONS]
|DIRECTION ACTION [OPTIONS] # disabled rule

DIRECTION MACRO(ACTION) [OPTIONS] # use predefined macro</pre>
</div></div>
<div class="paragraph">
<p>The following options can be used to refine rule matches.</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<span class="monospaced">--dest</span> <span class="monospaced">&lt;string&gt;</span> 
</dt>
<dd>
<p>
Restrict packet destination address. This can refer to a single IP address, an IP set (<em>+ipsetname</em>) or an IP alias definition. You can also specify an address range like <em>20.34.101.207-201.3.9.99</em>, or a list of IP addresses and networks (entries are separated by comma). Please do not mix IPv4 and IPv6 addresses inside such lists.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--dport</span> <span class="monospaced">&lt;string&gt;</span> 
</dt>
<dd>
<p>
Restrict TCP/UDP destination port. You can use service names or simple numbers (0-65535), as defined in <em>/etc/services</em>. Port ranges can be specified with <em>\d+:\d+</em>, for example <em>80:85</em>, and you can use comma separated list to match several ports or ranges.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--icmp-type</span> <span class="monospaced">&lt;string&gt;</span> 
</dt>
<dd>
<p>
Specify icmp-type. Only valid if proto equals <em>icmp</em> or <em>icmpv6</em>/<em>ipv6-icmp</em>.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--iface</span> <span class="monospaced">&lt;string&gt;</span> 
</dt>
<dd>
<p>
Network interface name. You have to use network configuration key names for VMs and containers (<em>net\d+</em>). Host related rules can use arbitrary strings.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--log</span> <span class="monospaced">&lt;alert | crit | debug | emerg | err | info | nolog | notice | warning&gt;</span> 
</dt>
<dd>
<p>
Log level for firewall rule.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--proto</span> <span class="monospaced">&lt;string&gt;</span> 
</dt>
<dd>
<p>
IP protocol. You can use protocol names (<em>tcp</em>/<em>udp</em>) or simple numbers, as defined in <em>/etc/protocols</em>.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--source</span> <span class="monospaced">&lt;string&gt;</span> 
</dt>
<dd>
<p>
Restrict packet source address. This can refer to a single IP address, an IP set (<em>+ipsetname</em>) or an IP alias definition. You can also specify an address range like <em>20.34.101.207-201.3.9.99</em>, or a list of IP addresses and networks (entries are separated by comma). Please do not mix IPv4 and IPv6 addresses inside such lists.
</p>
</dd>
<dt class="hdlist1">
<span class="monospaced">--sport</span> <span class="monospaced">&lt;string&gt;</span> 
</dt>
<dd>
<p>
Restrict TCP/UDP source port. You can use service names or simple numbers (0-65535), as defined in <em>/etc/services</em>. Port ranges can be specified with <em>\d+:\d+</em>, for example <em>80:85</em>, and you can use comma separated list to match several ports or ranges.
</p>
</dd>
</dl></div>
<div class="paragraph">
<p>Here are some examples:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>[RULES]
IN SSH(ACCEPT) -i net0
IN SSH(ACCEPT) -i net0 # a comment
IN SSH(ACCEPT) -i net0 -source 192.168.2.192 # only allow SSH from 192.168.2.192
IN SSH(ACCEPT) -i net0 -source 10.0.0.1-10.0.0.10 # accept SSH for IP range
IN SSH(ACCEPT) -i net0 -source 10.0.0.1,10.0.0.2,10.0.0.3 #accept ssh for IP list
IN SSH(ACCEPT) -i net0 -source +mynetgroup # accept ssh for ipset mynetgroup
IN SSH(ACCEPT) -i net0 -source myserveralias #accept ssh for alias myserveralias

|IN SSH(ACCEPT) -i net0 # disabled rule

IN  DROP # drop all incoming packages
OUT ACCEPT # accept all outgoing packages</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="pve_firewall_security_groups">
Security Groups
 <a class="headerlink" href="#pve_firewall_security_groups" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A security group is a collection of rules, defined at cluster level, which
can be used in all VMs' rules. For example you can define a group named
&#8220;webserver&#8221; with rules to open the <em>http</em> and <em>https</em> ports.</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre># /etc/pve/firewall/cluster.fw

[group webserver]
IN  ACCEPT -p tcp -dport 80
IN  ACCEPT -p tcp -dport 443</pre>
</div></div>
<div class="paragraph">
<p>Then, you can add this group to a VM&#8217;s firewall</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre># /etc/pve/firewall/&lt;VMID&gt;.fw

[RULES]
GROUP webserver</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="pve_firewall_ip_aliases">
IP Aliases
 <a class="headerlink" href="#pve_firewall_ip_aliases" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>IP Aliases allow you to associate IP addresses of networks with a
name. You can then refer to those names:</p></div>
<div class="ulist"><ul>
<li>
<p>
inside IP set definitions
</p>
</li>
<li>
<p>
in <span class="monospaced">source</span> and <span class="monospaced">dest</span> properties of firewall rules
</p>
</li>
</ul></div>
<div class="sect2">
<h3 id="_standard_ip_alias_span_class_monospaced_local_network_span">
<span>Standard IP Alias <span class="monospaced">local_network</span></span>
 <a class="headerlink" href="#_standard_ip_alias_span_class_monospaced_local_network_span" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>This alias is automatically defined. Please use the following command
to see assigned values:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre># pve-firewall localnet
local hostname: example
local IP address: 192.168.2.100
network auto detect: 192.168.0.0/20
using detected local_network: 192.168.0.0/20</pre>
</div></div>
<div class="paragraph">
<p>The firewall automatically sets up rules to allow everything needed
for cluster communication (corosync, API, SSH) using this alias.</p></div>
<div class="paragraph">
<p>The user can overwrite these values in the <span class="monospaced">cluster.fw</span> alias
section. If you use a single host on a public network, it is better to
explicitly assign the local IP address</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>#  /etc/pve/firewall/cluster.fw
[ALIASES]
local_network 1.2.3.4 # use the single IP address</pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pve_firewall_ip_sets">
IP Sets
 <a class="headerlink" href="#pve_firewall_ip_sets" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>IP sets can be used to define groups of networks and hosts. You can
refer to them with &#8216;+name` in the firewall rules&#8217; <span class="monospaced">source</span> and <span class="monospaced">dest</span>
properties.</p></div>
<div class="paragraph">
<p>The following example allows HTTP traffic from the <span class="monospaced">management</span> IP
set.</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>IN HTTP(ACCEPT) -source +management</pre>
</div></div>
<div class="sect2">
<h3 id="_standard_ip_set_span_class_monospaced_management_span">
<span>Standard IP set <span class="monospaced">management</span></span>
 <a class="headerlink" href="#_standard_ip_set_span_class_monospaced_management_span" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>This IP set applies only to host firewalls (not VM firewalls).  Those
IPs are allowed to do normal management tasks (Proxmox VE GUI, VNC, SPICE,
SSH).</p></div>
<div class="paragraph">
<p>The local cluster network is automatically added to this IP set (alias
<span class="monospaced">cluster_network</span>), to enable inter-host cluster
communication. (multicast,ssh,&#8230;)</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre># /etc/pve/firewall/cluster.fw

[IPSET management]
192.168.2.10
192.168.2.10/24</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_standard_ip_set_span_class_monospaced_blacklist_span">
<span>Standard IP set <span class="monospaced">blacklist</span></span>
 <a class="headerlink" href="#_standard_ip_set_span_class_monospaced_blacklist_span" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>Traffic from these IPs is dropped by every host&#8217;s and VM&#8217;s firewall.</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre># /etc/pve/firewall/cluster.fw

[IPSET blacklist]
77.240.159.182
213.87.123.0/24</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="pve_firewall_ipfilter_section">
<span>Standard IP set <span class="monospaced">ipfilter-net*</span></span>
 <a class="headerlink" href="#pve_firewall_ipfilter_section" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>These filters belong to a VM&#8217;s network interface and are mainly used to prevent
IP spoofing. If such a set exists for an interface then any outgoing traffic
with a source IP not matching its interface&#8217;s corresponding ipfilter set will
be dropped.</p></div>
<div class="paragraph">
<p>For containers with configured IP addresses these sets, if they exist (or are
activated via the general <span class="monospaced">IP Filter</span> option in the VM&#8217;s firewall&#8217;s <strong>options</strong>
tab), implicitly contain the associated IP addresses.</p></div>
<div class="paragraph">
<p>For both virtual machines and containers they also implicitly contain the
standard MAC-derived IPv6 link-local address in order to allow the neighbor
discovery protocol to work.</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>/etc/pve/firewall/&lt;VMID&gt;.fw

[IPSET ipfilter-net0] # only allow specified IPs on net0
192.168.2.10</pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pve_firewall_services_commands">
Services and Commands
 <a class="headerlink" href="#pve_firewall_services_commands" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The firewall runs two service daemons on each node:</p></div>
<div class="ulist"><ul>
<li>
<p>
pvefw-logger: NFLOG daemon (ulogd replacement).
</p>
</li>
<li>
<p>
pve-firewall: updates iptables rules
</p>
</li>
</ul></div>
<div class="paragraph">
<p>There is also a CLI command named <span class="monospaced">pve-firewall</span>, which can be used to
start and stop the firewall service:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre># pve-firewall start
# pve-firewall stop</pre>
</div></div>
<div class="paragraph">
<p>To get the status use:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre># pve-firewall status</pre>
</div></div>
<div class="paragraph">
<p>The above command reads and compiles all firewall rules, so you will
see warnings if your firewall configuration contains any errors.</p></div>
<div class="paragraph">
<p>If you want to see the generated iptables rules you can use:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre># iptables-save</pre>
</div></div>
</div>
</div>
<div class="sect1">
<h2 id="pve_firewall_default_rules">
Default firewall rules
 <a class="headerlink" href="#pve_firewall_default_rules" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following traffic is filtered by the default firewall configuration:</p></div>
<div class="sect2">
<h3 id="_datacenter_incoming_outgoing_drop_reject">
<span>Datacenter incoming/outgoing DROP/REJECT</span>
 <a class="headerlink" href="#_datacenter_incoming_outgoing_drop_reject" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>If the input or output policy for the firewall is set to DROP or REJECT, the
following traffic is still allowed for all Proxmox VE hosts in the cluster:</p></div>
<div class="ulist"><ul>
<li>
<p>
traffic over the loopback interface
</p>
</li>
<li>
<p>
already established connections
</p>
</li>
<li>
<p>
traffic using the IGMP protocol
</p>
</li>
<li>
<p>
TCP traffic from management hosts to port 8006 in order to allow access to
  the web interface
</p>
</li>
<li>
<p>
TCP traffic from management hosts to the port range 5900 to 5999 allowing
  traffic for the VNC web console
</p>
</li>
<li>
<p>
TCP traffic from management hosts to port 3128 for connections to the SPICE
  proxy
</p>
</li>
<li>
<p>
TCP traffic from management hosts to port 22 to allow ssh access
</p>
</li>
<li>
<p>
UDP traffic in the cluster network to ports 5405-5412 for corosync
</p>
</li>
<li>
<p>
UDP multicast traffic in the cluster network
</p>
</li>
<li>
<p>
ICMP traffic type 3 (Destination Unreachable), 4 (congestion control) or 11
  (Time Exceeded)
</p>
</li>
</ul></div>
<div class="paragraph">
<p>The following traffic is dropped, but not logged even with logging enabled:</p></div>
<div class="ulist"><ul>
<li>
<p>
TCP connections with invalid connection state
</p>
</li>
<li>
<p>
Broadcast, multicast and anycast traffic not related to corosync, i.e., not
  coming through ports 5405-5412
</p>
</li>
<li>
<p>
TCP traffic to port 43
</p>
</li>
<li>
<p>
UDP traffic to ports 135 and 445
</p>
</li>
<li>
<p>
UDP traffic to the port range 137 to 139
</p>
</li>
<li>
<p>
UDP traffic form source port 137 to port range 1024 to 65535
</p>
</li>
<li>
<p>
UDP traffic to port 1900
</p>
</li>
<li>
<p>
TCP traffic to port 135, 139 and 445
</p>
</li>
<li>
<p>
UDP traffic originating from source port 53
</p>
</li>
</ul></div>
<div class="paragraph">
<p>The rest of the traffic is dropped or rejected, respectively, and also logged.
This may vary depending on the additional options enabled in
<strong>Firewall</strong> &#8594; <strong>Options</strong>, such as NDP, SMURFS and TCP flag filtering.</p></div>
<div class="paragraph" id="pve_firewall_iptables_inspect">
<p>Please inspect the output of the</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre> # iptables-save</pre>
</div></div>
<div class="paragraph">
<p>system command to see the firewall chains and rules active on your system.
This output is also included in a <span class="monospaced">System Report</span>, accessible over a node&#8217;s
subscription tab in the web GUI, or through the <span class="monospaced">pvereport</span> command-line tool.</p></div>
</div>
<div class="sect2">
<h3 id="_vm_ct_incoming_outgoing_drop_reject">
<span>VM/CT incoming/outgoing DROP/REJECT</span>
 <a class="headerlink" href="#_vm_ct_incoming_outgoing_drop_reject" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>This drops or rejects all the traffic to the VMs, with some exceptions for
DHCP, NDP, Router Advertisement, MAC and IP filtering depending on the set
configuration.  The same rules for dropping/rejecting packets are inherited
from the datacenter, while the exceptions for accepted incoming/outgoing
traffic of the host do not apply.</p></div>
<div class="paragraph">
<p>Again, you can use <a href="pve-firewall.8.html#pve_firewall_iptables_inspect">iptables-save (see above)</a>
to inspect all rules and chains applied.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging_of_firewall_rules">
Logging of firewall rules
 <a class="headerlink" href="#_logging_of_firewall_rules" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, all logging of traffic filtered by the firewall rules is disabled.
To enable logging, the <span class="monospaced">loglevel</span> for incoming and/or outgoing traffic has to be
set in <strong>Firewall</strong> &#8594; <strong>Options</strong>. This can be done for the host as well as for the
VM/CT firewall individually. By this, logging of Proxmox VE&#8217;s standard firewall rules
is enabled and the output can be observed in <strong>Firewall</strong> &#8594; <strong>Log</strong>.
Further, only some dropped or rejected packets are logged for the standard rules
(see <a href="pve-firewall.8.html#pve_firewall_default_rules">default firewall rules</a>).</p></div>
<div class="paragraph">
<p><span class="monospaced">loglevel</span> does not affect how much of the filtered traffic is logged. It
changes a <span class="monospaced">LOGID</span> appended as prefix to the log output for easier filtering and
post-processing.</p></div>
<div class="paragraph">
<p><span class="monospaced">loglevel</span> is one of the following flags:</p></div>
<table class="tableblock frame-all grid-all" id="pve_firewall_log_levels"
style="
width:25%;
">
<col style="width:50%;">
<col style="width:50%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" > loglevel </th>
<th class="tableblock halign-left valign-top" > LOGID</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">nolog</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">&#8201;&#8212;&#8201;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">emerg</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">alert</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">crit</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">err</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">warning</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">notice</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">info</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">debug</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">7</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>A typical firewall log output looks like this:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>VMID LOGID CHAIN TIMESTAMP POLICY: PACKET_DETAILS</pre>
</div></div>
<div class="paragraph">
<p>In case of the host firewall, <span class="monospaced">VMID</span> is equal to 0.</p></div>
<div class="sect2">
<h3 id="_logging_of_user_defined_firewall_rules">
<span>Logging of user defined firewall rules</span>
 <a class="headerlink" href="#_logging_of_user_defined_firewall_rules" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>In order to log packets filtered by user-defined firewall rules, it is possible
to set a log-level parameter for each rule individually.
This allows to log in a fine grained manner and independent of the log-level
defined for the standard rules in <strong>Firewall</strong> &#8594; <strong>Options</strong>.</p></div>
<div class="paragraph">
<p>While the <span class="monospaced">loglevel</span> for each individual rule can be defined or changed easily
in the web UI during creation or modification of the rule, it is possible to set
this also via the corresponding <span class="monospaced">pvesh</span> API calls.</p></div>
<div class="paragraph">
<p>Further, the log-level can also be set via the firewall configuration file by
appending a <span class="monospaced">-log &lt;loglevel&gt;</span> to the selected rule (see
<a href="pve-firewall.8.html#pve_firewall_log_levels">possible log-levels</a>).</p></div>
<div class="paragraph">
<p>For example, the following two are identical:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>IN REJECT -p icmp -log nolog
IN REJECT -p icmp</pre>
</div></div>
<div class="paragraph">
<p>whereas</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>IN REJECT -p icmp -log debug</pre>
</div></div>
<div class="paragraph">
<p>produces a log output flagged with the <span class="monospaced">debug</span> level.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tips_and_tricks">
Tips and Tricks
 <a class="headerlink" href="#_tips_and_tricks" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_how_to_allow_ftp">
<span>How to allow FTP</span>
 <a class="headerlink" href="#_how_to_allow_ftp" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>FTP is an old style protocol which uses port 21 and several other dynamic ports. So you
need a rule to accept port 21. In addition, you need to load the <span class="monospaced">ip_conntrack_ftp</span> module.
So please run:</p></div>
<div class="literalblock">
<div class="content monospaced">
<pre>modprobe ip_conntrack_ftp</pre>
</div></div>
<div class="paragraph">
<p>and add <span class="monospaced">ip_conntrack_ftp</span> to <span class="monospaced">/etc/modules</span> (so that it works after a reboot).</p></div>
</div>
<div class="sect2">
<h3 id="_suricata_ips_integration">
<span>Suricata IPS integration</span>
 <a class="headerlink" href="#_suricata_ips_integration" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>If you want to use the <a href="https://suricata.io/">Suricata IPS</a>
(Intrusion Prevention System), it&#8217;s possible.</p></div>
<div class="paragraph">
<p>Packets will be forwarded to the IPS only after the firewall ACCEPTed
them.</p></div>
<div class="paragraph">
<p>Rejected/Dropped firewall packets don&#8217;t go to the IPS.</p></div>
<div class="paragraph">
<p>Install suricata on proxmox host:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre># apt-get install suricata
# modprobe nfnetlink_queue</pre>
</div></div>
<div class="paragraph">
<p>Don&#8217;t forget to add <span class="monospaced">nfnetlink_queue</span> to <span class="monospaced">/etc/modules</span> for next reboot.</p></div>
<div class="paragraph">
<p>Then, enable IPS for a specific VM with:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre># /etc/pve/firewall/&lt;VMID&gt;.fw

[OPTIONS]
ips: 1
ips_queues: 0</pre>
</div></div>
<div class="paragraph">
<p><span class="monospaced">ips_queues</span> will bind a specific cpu queue for this VM.</p></div>
<div class="paragraph">
<p>Available queues are defined in</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre># /etc/default/suricata
NFQUEUE=0</pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_notes_on_ipv6">
Notes on IPv6
 <a class="headerlink" href="#_notes_on_ipv6" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The firewall contains a few IPv6 specific options. One thing to note is that
IPv6 does not use the ARP protocol anymore, and instead uses NDP (Neighbor
Discovery Protocol) which works on IP level and thus needs IP addresses to
succeed. For this purpose link-local addresses derived from the interface&#8217;s MAC
address are used. By default the <span class="monospaced">NDP</span> option is enabled on both host and VM
level to allow neighbor discovery (NDP) packets to be sent and received.</p></div>
<div class="paragraph">
<p>Beside neighbor discovery NDP is also used for a couple of other things, like
auto-configuration and advertising routers.</p></div>
<div class="paragraph">
<p>By default VMs are allowed to send out router solicitation messages (to query
for a router), and to receive router advertisement packets. This allows them to
use stateless auto configuration. On the other hand VMs cannot advertise
themselves as routers unless the &#8220;Allow Router Advertisement&#8221; (<span class="monospaced">radv: 1</span>) option
is set.</p></div>
<div class="paragraph">
<p>As for the link local addresses required for NDP, there&#8217;s also an &#8220;IP Filter&#8221;
(<span class="monospaced">ipfilter: 1</span>) option which can be enabled which has the same effect as adding
an <span class="monospaced">ipfilter-net*</span> ipset for each of the VM&#8217;s network interfaces containing the
corresponding link local addresses.  (See the
<a href="pve-firewall.8.html#pve_firewall_ipfilter_section">Standard IP set <span class="monospaced">ipfilter-net*</span></a> section for details.)</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_ports_used_by_proxmox_ve">
Ports used by Proxmox VE
 <a class="headerlink" href="#_ports_used_by_proxmox_ve" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
Web interface: 8006 (TCP, HTTP/1.1 over TLS)
</p>
</li>
<li>
<p>
VNC Web console: 5900-5999 (TCP, WebSocket)
</p>
</li>
<li>
<p>
SPICE proxy: 3128 (TCP)
</p>
</li>
<li>
<p>
sshd (used for cluster actions): 22 (TCP)
</p>
</li>
<li>
<p>
rpcbind: 111 (UDP)
</p>
</li>
<li>
<p>
sendmail: 25 (TCP, outgoing)
</p>
</li>
<li>
<p>
corosync cluster traffic: 5405-5412 UDP
</p>
</li>
<li>
<p>
live migration (VM memory and local-disk data): 60000-60050 (TCP)
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="pve_firewall_nft">
nftables
 <a class="headerlink" href="#pve_firewall_nft" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As an alternative to <span class="monospaced">pve-firewall</span> we offer <span class="monospaced">proxmox-firewall</span>, which is an
implementation of the Proxmox VE firewall based on the newer
<a href="https://wiki.nftables.org/wiki-nftables/index.php/What_is_nftables%3F">nftables</a>
rather than iptables.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Warning" src="data:image/png;base64,
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
/F/lgJiyQFHragAAAABJRU5ErkJggg==">
</td>
<td class="content"><span class="monospaced">proxmox-firewall</span> is currently in tech preview. There might be bugs or
incompatibilities with the original firewall. It is currently not suited for
production use.</td>
</tr></table>
</div>
<div class="paragraph">
<p>This implementation uses the same configuration files and configuration format,
so you can use your old configuration when switching. It provides the exact same
functionality with a few exceptions:</p></div>
<div class="ulist"><ul>
<li>
<p>
REJECT is currently not possible for guest traffic (traffic will instead be
  dropped).
</p>
</li>
<li>
<p>
Using the <span class="monospaced">NDP</span>, <span class="monospaced">Router Advertisement</span> or <span class="monospaced">DHCP</span> options will <strong>always</strong> create
  firewall rules, irregardless of your default policy.
</p>
</li>
<li>
<p>
firewall rules for guests are evaluated even for connections that have
  conntrack table entries.
</p>
</li>
</ul></div>
<div class="sect2">
<h3 id="_installation_and_usage">
<span>Installation and Usage</span>
 <a class="headerlink" href="#_installation_and_usage" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>Install the <span class="monospaced">proxmox-firewall</span> package:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>apt install proxmox-firewall</pre>
</div></div>
<div class="paragraph">
<p>Enable the nftables backend via the Web UI on your hosts (Host &gt; Firewall &gt;
Options &gt; nftables), or by enabling it in the configuration file for your hosts
(<span class="monospaced">/etc/pve/nodes/&lt;node_name&gt;/host.fw</span>):</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>[OPTIONS]

nftables: 1</pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Note" src="data:image/png;base64,
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">
</td>
<td class="content">After enabling/disabling <span class="monospaced">proxmox-firewall</span>, all running VMs and
containers need to be restarted for the old/new firewall to work properly.</td>
</tr></table>
</div>
<div class="paragraph">
<p>After setting the <span class="monospaced">nftables</span> configuration key, the new <span class="monospaced">proxmox-firewall</span>
service will take over. You can check if the new service is working by
checking the systemctl status of <span class="monospaced">proxmox-firewall</span>:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>systemctl status proxmox-firewall</pre>
</div></div>
<div class="paragraph">
<p>You can also examine the generated ruleset. You can find more information about
this in the section <a href="pve-firewall.8.html#pve_firewall_nft_helpful_commands">Helpful Commands</a>.
You should also check whether <span class="monospaced">pve-firewall</span> is no longer generating iptables
rules, you can find the respective commands in the
<a href="pve-firewall.8.html#pve_firewall_services_commands">Services and Commands</a> section.</p></div>
<div class="paragraph">
<p>Switching back to the old firewall can be done by simply setting the
configuration value back to 0 / No.</p></div>
</div>
<div class="sect2">
<h3 id="_usage">
<span>Usage</span>
 <a class="headerlink" href="#_usage" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p><span class="monospaced">proxmox-firewall</span> will create two tables that are managed by the
<span class="monospaced">proxmox-firewall</span> service: <span class="monospaced">proxmox-firewall</span> and <span class="monospaced">proxmox-firewall-guests</span>. If
you want to create custom rules that live outside the Proxmox VE firewall
configuration you can create your own tables to manage your custom firewall
rules. <span class="monospaced">proxmox-firewall</span> will only touch the tables it generates, so you can
easily extend and modify the behavior of the <span class="monospaced">proxmox-firewall</span> by adding your
own tables.</p></div>
<div class="paragraph">
<p>Instead of using the <span class="monospaced">pve-firewall</span> command, the nftables-based firewall uses
<span class="monospaced">proxmox-firewall</span>. It is a systemd service, so you can start and stop it via
<span class="monospaced">systemctl</span>:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>systemctl start proxmox-firewall
systemctl stop proxmox-firewall</pre>
</div></div>
<div class="paragraph">
<p>Stopping the firewall service will remove all generated rules.</p></div>
<div class="paragraph">
<p>To query the status of the firewall, you can query the status of the systemctl
service:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>systemctl status proxmox-firewall</pre>
</div></div>
</div>
<div class="sect2">
<h3 id="pve_firewall_nft_helpful_commands">
<span>Helpful Commands</span>
 <a class="headerlink" href="#pve_firewall_nft_helpful_commands" title="Permalink to this heading"></a>
</h3>
<div class="paragraph">
<p>You can check the generated ruleset via the following command:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>nft list ruleset</pre>
</div></div>
<div class="paragraph">
<p>If you want to debug <span class="monospaced">proxmox-firewall</span> you can simply run the daemon in
foreground with the <span class="monospaced">RUST_LOG</span> environment variable set to <span class="monospaced">trace</span>. This should
provide you with detailed debugging output:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>RUST_LOG=trace /usr/libexec/proxmox/proxmox-firewall</pre>
</div></div>
<div class="paragraph">
<p>You can also edit the systemctl service if you want to have detailed output for
your firewall daemon:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>systemctl edit proxmox-firewall</pre>
</div></div>
<div class="paragraph">
<p>Then you need to add the override for the <span class="monospaced">RUST_LOG</span> environment variable:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>[Service]
Environment="RUST_LOG=trace"</pre>
</div></div>
<div class="paragraph">
<p>This will generate a large amount of logs very quickly, so only use this for
debugging purposes. Other, less verbose, log levels are <span class="monospaced">info</span> and <span class="monospaced">debug</span>.</p></div>
<div class="paragraph">
<p>Running in foreground writes the log output to STDERR, so you can redirect it
with the following command (e.g. for submitting logs to the community forum):</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>RUST_LOG=trace /usr/libexec/proxmox/proxmox-firewall 2&gt; firewall_log_$(hostname).txt</pre>
</div></div>
<div class="paragraph">
<p>It can be helpful to trace packet flow through the different chains in order to
debug firewall rules. This can be achieved by setting <span class="monospaced">nftrace</span> to 1 for packets
that you want to track. It is advisable that you do not set this flag for <strong>all</strong>
packets, in the example below we only examine ICMP packets.</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>#!/usr/sbin/nft -f
table bridge tracebridge
delete table bridge tracebridge

table bridge tracebridge {
    chain trace {
        meta l4proto icmp meta nftrace set 1
    }

    chain prerouting {
        type filter hook prerouting priority -350; policy accept;
        jump trace
    }

    chain postrouting {
        type filter hook postrouting priority -350; policy accept;
        jump trace
    }
}</pre>
</div></div>
<div class="paragraph">
<p>Saving this file, making it executable, and then running it once will create the
respective tracing chains. You can then inspect the tracing output via the
Proxmox VE Web UI (Firewall &gt; Log) or via <span class="monospaced">nft monitor trace</span>.</p></div>
<div class="paragraph">
<p>The above example traces traffic on all bridges, which is usually where guest
traffic flows through. If you want to examine host traffic, create those chains
in the <span class="monospaced">inet</span> table instead of the <span class="monospaced">bridge</span> table.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img alt="Note" src="data:image/png;base64,
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">
</td>
<td class="content">Be aware that this can generate a <strong>lot</strong> of log spam and slow down the
performance of your networking stack significantly.</td>
</tr></table>
</div>
<div class="paragraph">
<p>You can remove the tracing rules via running the following command:</p></div>
<div class="listingblock">
<div class="content monospaced">
<pre>nft delete table bridge tracebridge</pre>
</div></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_macro_definitions">
Macro Definitions
 <a class="headerlink" href="#_macro_definitions" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Amanda</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Amanda Backup
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">10080</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">10080</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Auth</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Auth (identd) traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">113</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>BGP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Border Gateway Protocol traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">179</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>BitTorrent</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
BitTorrent traffic for BitTorrent 3.1 and earlier
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6881:6889</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6881</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>BitTorrent32</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
BitTorrent traffic for BitTorrent 3.2 and later
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6881:6999</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6881</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>CVS</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Concurrent Versions System pserver traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2401</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Ceph</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Ceph Storage Cluster traffic (Ceph Monitors, OSD &amp; MDS Daemons)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6789</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3300</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6800:7300</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Citrix</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Citrix/ICA traffic (ICA, ICA Browser, CGP)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1494</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1604</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2598</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>DAAP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Digital Audio Access Protocol traffic (iTunes, Rythmbox daemons)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3689</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3689</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>DCC</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Distributed Checksum Clearinghouse spam filtering mechanism
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6277</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>DHCPfwd</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Forwarded DHCP traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">67:68</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">67:68</p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>DHCPv6</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
DHCPv6 traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">546:547</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">546:547</p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>DNS</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Domain Name System traffic (upd and tcp)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">53</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">53</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Distcc</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Distributed Compiler service
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3632</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>FTP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
File Transfer Protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">21</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Finger</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Finger protocol (RFC 742)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">79</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>GNUnet</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
GNUnet secure peer-to-peer networking traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2086</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2086</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1080</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1080</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>GRE</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Generic Routing Encapsulation tunneling protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">47</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Git</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Git distributed revision control traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">9418</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>HKP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
OpenPGP HTTP key server protocol traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">11371</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>HTTP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Hypertext Transfer Protocol (WWW)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">80</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>HTTPS</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Hypertext Transfer Protocol (WWW) over SSL
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>ICPV2</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Internet Cache Protocol V2 (Squid) traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3130</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>ICQ</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
AOL Instant Messenger traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5190</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>IMAP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Internet Message Access Protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">143</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>IMAPS</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Internet Message Access Protocol over SSL
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">993</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>IPIP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
IPIP capsulation traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">94</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>IPsec</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
IPsec traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">500</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">50</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>IPsecah</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
IPsec authentication (AH) traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">500</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">51</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>IPsecnat</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
IPsec traffic and Nat-Traversal
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">500</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4500</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">50</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>IRC</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Internet Relay Chat traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6667</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Jetdirect</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
HP Jetdirect printing
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">9100</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>L2TP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Layer 2 Tunneling Protocol traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1701</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>LDAP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Lightweight Directory Access Protocol traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">389</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>LDAPS</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Secure Lightweight Directory Access Protocol traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">636</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>MDNS</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Multicast DNS
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5353</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>MSNP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Microsoft Notification Protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1863</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>MSSQL</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Microsoft SQL Server
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1433</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Mail</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Mail traffic (SMTP, SMTPS, Submission)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">25</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">465</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">587</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Munin</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Munin networked resource monitoring traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">4949</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>MySQL</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
MySQL server
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3306</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>NNTP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
NNTP traffic (Usenet).
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">119</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>NNTPS</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Encrypted NNTP traffic (Usenet)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">563</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>NTP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Network Time Protocol (ntpd)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">123</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>NeighborDiscovery</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
IPv6 neighbor solicitation, neighbor and router advertisement
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">icmpv6</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">router-solicitation</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">icmpv6</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">router-advertisement</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">icmpv6</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">neighbor-solicitation</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">icmpv6</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">neighbor-advertisement</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>OSPF</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
OSPF multicast traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">89</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>OpenVPN</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
OpenVPN traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1194</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>PCA</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Symantec PCAnywere (tm)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5632</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5631</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>PMG</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Proxmox Mail Gateway web interface
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">8006</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>POP3</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
POP3 traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">110</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>POP3S</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Encrypted POP3 traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">995</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>PPtP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Point-to-Point Tunneling Protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">47</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1723</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Ping</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
ICMP echo request
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">icmp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">echo-request</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>PostgreSQL</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
PostgreSQL server
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5432</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Printer</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Line Printer protocol printing
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">515</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>RDP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Microsoft Remote Desktop Protocol traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3389</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>RIP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Routing Information Protocol (bidirectional)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">520</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>RNDC</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
BIND remote management protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">953</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Razor</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Razor Antispam System
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">2703</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Rdate</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Remote time retrieval (rdate)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">37</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Rsync</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Rsync server
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">873</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SANE</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
SANE network scanning
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">6566</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SMB</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Microsoft SMB traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">135,445</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">137:139</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">1024:65535</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">137</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">135,139,445</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SMBswat</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Samba Web Administration Tool
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">901</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SMTP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Simple Mail Transfer Protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">25</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SMTPS</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Encrypted Simple Mail Transfer Protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">465</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SNMP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Simple Network Management Protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">161:162</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">161</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SPAMD</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Spam Assassin SPAMD traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">783</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SPICEproxy</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Proxmox VE SPICE display proxy traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3128</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SSH</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Secure shell traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">22</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SVN</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Subversion server (svnserve)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3690</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>SixXS</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
SixXS IPv6 Deployment and Tunnel Broker
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3874</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3740</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">41</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5072,8374</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Squid</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Squid web proxy traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">3128</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Submission</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Mail message submission traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">587</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Syslog</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Syslog protocol (RFC 5424) traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">514</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">514</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>TFTP</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Trivial File Transfer Protocol traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">69</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Telnet</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Telnet traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">23</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Telnets</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Telnet over SSL
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">992</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Time</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
RFC 868 Time protocol
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">37</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Trcrt</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Traceroute (for up to 30 hops) traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">udp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">33434:33524</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">icmp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">echo-request</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>VNC</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
VNC traffic for VNC display&#8217;s 0 - 99
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5900:5999</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>VNCL</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
VNC traffic from Vncservers to Vncviewers in listen mode
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">5500</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Web</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
WWW traffic (HTTP and HTTPS)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">80</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">443</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Webcache</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Web Cache/Proxy traffic (port 8080)
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">8080</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Webmin</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Webmin traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">10000</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<em>Whois</em>
<br>
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Whois (nicname, RFC 3912) traffic
</p>
</td>
</tr>
</table></div>
<table class="tableblock frame-all grid-all"
style="
width:100%;
">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<col style="width:25%;">
<thead>
<tr>
<th class="tableblock halign-left valign-top" >Action</th>
<th class="tableblock halign-left valign-top" >proto</th>
<th class="tableblock halign-left valign-top" >dport</th>
<th class="tableblock halign-left valign-top" >sport</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top" ><p class="tableblock">PARAM</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">tcp</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock">43</p></td>
<td class="tableblock halign-left valign-top" ><p class="tableblock"></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_copyright_and_disclaimer">
Copyright and Disclaimer
 <a class="headerlink" href="#_copyright_and_disclaimer" title="Permalink to this heading"></a>
</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Copyright &#169; 2007-2022 Proxmox Server Solutions GmbH</p></div>
<div class="paragraph">
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as
published by the Free Software Foundation, either version 3 of the
License, or (at your option) any later version.</p></div>
<div class="paragraph">
<p>This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
Affero General Public License for more details.</p></div>
<div class="paragraph">
<p>You should have received a copy of the GNU Affero General Public
License along with this program.  If not, see
<a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a></p></div>
</div>
</div>
</div>
<div id="footnotes"><hr></div>
<div id="footer">
<div id="footer-text">
Version 8.4.0<br>
Last updated
 Wed Apr  9 08:00:00 CEST 2025
</div>
</div>
</body>
</html>
